<html>
<head>
<title>mo.cpp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: #999999; font-weight: normal; font-style: normal; }
.s0 { color: rgb(128,128,128); font-style: italic; }
.s1 { color: rgb(0,0,0); }
.s2 { color: rgb(128,128,0); }
.s3 { color: rgb(0,128,0); font-weight: bold; }
.s4 { color: rgb(0,0,255); }
.s5 { color: rgb(0,0,128); font-weight: bold; }
</style>
</head>
<BODY BGCOLOR="#ffffff">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
mo.cpp</FONT>
</center></TD></TR></TABLE>
<pre>
<span class="s0">//Given a sequence of n numbers a1, a2, ..., an and a number of d-queries.</span><span class="s1"> 
</span><span class="s0">//A d-query is a pair (i, j) (1 ≤ i ≤ j ≤ n). For each d-query (i, j), you have</span><span class="s1"> 
</span><span class="s0">//to return the number of distinct elements in the subsequence ai, ai+1, ..., aj.</span><span class="s1"> 
</span><span class="s2">#include</span><span class="s3">&lt;bits/stdc++.h&gt;</span><span class="s1"> 
</span><span class="s2">#define </span><span class="s1">TAM </span><span class="s4">30000 </span><span class="s1">+ </span><span class="s4">7</span><span class="s1"> 
</span><span class="s2">#define </span><span class="s1">QTAM </span><span class="s4">200000 </span><span class="s1">+ </span><span class="s4">7</span><span class="s1"> 
</span><span class="s2">#define </span><span class="s1">MTAM </span><span class="s4">1000000 </span><span class="s1">+ </span><span class="s4">7</span><span class="s1"> 
 
</span><span class="s5">using namespace </span><span class="s1">std; 
 
</span><span class="s5">int </span><span class="s1">a[TAM], r[QTAM], cnt[MTAM]; 
</span><span class="s5">int </span><span class="s1">ans, BLOCK, currL , currR ; 
 
</span><span class="s5">struct </span><span class="s1">node{ 
    </span><span class="s5">int </span><span class="s1">L, R, idx; 
}q[QTAM]; 
 
</span><span class="s5">bool </span><span class="s1">comp(node a, node b){ 
    </span><span class="s5">if</span><span class="s1">(a.L/BLOCK &lt; b.L/BLOCK) </span><span class="s5">return true</span><span class="s1">; 
    </span><span class="s5">if</span><span class="s1">(a.L/BLOCK &gt; b.L/BLOCK) </span><span class="s5">return false</span><span class="s1">; 
    </span><span class="s5">return </span><span class="s1">a.R &lt; b.R; 
} 
 
</span><span class="s5">void </span><span class="s1">remove(</span><span class="s5">int </span><span class="s1">i){ 
    cnt[a[i]]--; 
    </span><span class="s5">if</span><span class="s1">(cnt[a[i]] == </span><span class="s4">0</span><span class="s1">)ans--; 
} 
 
</span><span class="s5">void </span><span class="s1">add(</span><span class="s5">int </span><span class="s1">i){ 
    cnt[a[i]]++; 
    </span><span class="s5">if</span><span class="s1">(cnt[a[i]]==</span><span class="s4">1</span><span class="s1">)ans++; 
} 
 
</span><span class="s5">int </span><span class="s1">query(node i){ 
    </span><span class="s5">while</span><span class="s1">(currL&lt; i.L){ 
        remove(currL); 
        currL++; 
    } 
    </span><span class="s5">while</span><span class="s1">(currL &gt; i.L){ 
        currL--; 
        add(currL); 
    } 
    </span><span class="s5">while</span><span class="s1">(currR&lt; i.R){ 
        currR++; 
        add(currR); 
    } 
    </span><span class="s5">while</span><span class="s1">(currR &gt; i.R){ 
        remove(currR); 
        currR--; 
    } 
    </span><span class="s5">return </span><span class="s1">ans; 
} 
 
</span><span class="s5">int </span><span class="s1">main(){ 
    </span><span class="s5">int </span><span class="s1">n, que; 
    cin&gt;&gt;n; 
    BLOCK = sqrt(n); 
    </span><span class="s5">for</span><span class="s1">(</span><span class="s5">int </span><span class="s1">i = </span><span class="s4">1</span><span class="s1">; i &lt;= n; i++)cin&gt;&gt;a[i]; 
 
    cin&gt;&gt;que; 
    </span><span class="s5">for</span><span class="s1">(</span><span class="s5">int </span><span class="s1">i = </span><span class="s4">1</span><span class="s1">; i &lt;= que; i++){ 
        cin&gt;&gt;q[i].L&gt;&gt;q[i].R; 
        q[i].idx = i; 
    } 
    sort(q +</span><span class="s4">1</span><span class="s1">, q + que+</span><span class="s4">1</span><span class="s1">, comp); 
 
    </span><span class="s5">for</span><span class="s1">(</span><span class="s5">int </span><span class="s1">i = </span><span class="s4">1</span><span class="s1">; i &lt;=que; i++) 
        r[q[i].idx] = query(q[i]); 
 
    </span><span class="s5">for</span><span class="s1">(</span><span class="s5">int </span><span class="s1">i = </span><span class="s4">1</span><span class="s1">; i &lt;= que; i++) 
        cout&lt;&lt;r[i]&lt;&lt;</span><span class="s3">&quot;</span><span class="s5">\n</span><span class="s3">&quot;</span><span class="s1">; 
} 
</span></pre>
</body>
</html>